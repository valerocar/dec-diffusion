(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42756,        990]
NotebookOptionsPosition[     41207,        963]
NotebookOutlinePosition[     41649,        980]
CellTagsIndexPosition[     41606,        977]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "NDSolve`FEM`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Base2D.nb\>\""}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookEvaluate", "[", "nb", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Global", " ", "variables"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxCellMeasure", "=", ".0001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"levelsCount", "=", "80"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "cross", " ", "sections"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{"1", "/", "4"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"width", " ", "of", " ", "channel"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ex1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"-", "w"}], "/", "2"}], ",", 
      RowBox[{"w", "/", "2"}]}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Example", " ", "1"}], " ", ":", " ", 
     RowBox[{"band", " ", "over", " ", "straight", " ", "line"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ex2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "Pi", " ", "u"}], "]"}], "/", "3"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"-", "w"}], "/", "2"}], ",", 
      RowBox[{"w", "/", "2"}]}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Example", " ", "2"}], ":", " ", 
     RowBox[{"band", " ", "over", " ", "sine", " ", "curve"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Channel", " ", "definition"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "v1", ",", "v2"}], "}"}], "=", "ex2"}], ";", 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Selection", " ", "of", " ", "example"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "borderA", ",", "borderB"}], "}"}], "=", 
    RowBox[{"FrenetChannel2D", "[", 
     RowBox[{"\[Alpha]", ",", "u", ",", "v", ",", "v1", ",", "v2"}], "]"}]}], 
   ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Getting", " ", "curve", " ", "and", " ", "side", " ", "walls"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mesh", ",", "\[Phi]"}], "}"}], "=", 
    RowBox[{"ParametricHarmonicData", "[", 
     RowBox[{
     "p", ",", "u", ",", "v", ",", "borderA", ",", "borderB", ",", 
      "maxCellMeasure"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"mesh", "[", "\"\<Wireframe\>\"", "]"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"levels", " ", "=", " ", 
    RowBox[{"LinSpace", "[", 
     RowBox[{"0", ",", "1", ",", "levelsCount"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ph", "=", 
    RowBox[{"ChannelPhysics", "[", 
     RowBox[{"mesh", ",", "\[Phi]", ",", "levels"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"ph", "[", "\"\<A\>\"", "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"length", " ", "of", " ", "cross", " ", "sections"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"\[Sigma]", "=", 
    RowBox[{"ph", "[", "\"\<\[Sigma]\>\"", "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Derivative", " ", "of", " ", "volume", " ", "function"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Nu]", "=", 
    RowBox[{"ph", "[", "\"\<\[Nu]\>\"", "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Volume", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"J", "=", 
    RowBox[{"ph", "[", "\"\<J\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"us", "=", 
    RowBox[{"ph", "[", "\"\<us\>\"", "]"}]}], ";", "                      ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Values", " ", "of", " ", "u", " ", "at", " ", "cross", " ", "sections"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"uDomain", "=", 
    RowBox[{"ph", "[", "\"\<domain\>\"", "]"}]}], ";", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Range", " ", "of", " ", "values", " ", "of", " ", "u"}], "-", 
     "variable"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Sus", "=", 
    RowBox[{"ph", "[", "\"\<Sus\>\"", "]"}]}], ";", "                  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Cross", " ", "sections"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"domain1", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"ph", "[", "\"\<domain\>\"", "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "u_", "]"}], ":=", 
   RowBox[{
    RowBox[{"J", "[", "u", "]"}], 
    RowBox[{"\[Sigma]", "[", "u", "]"}]}]}], ";", 
  "                                                                   ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Diffusion", " ", "coefficient", " ", "in", " ", "natural", " ", 
    "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Kappa]", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Curvature", "[", 
     RowBox[{"\[Alpha]", ",", "u"}], "]"}], "]"}]}], ";", 
  "                                               ", 
  RowBox[{"(*", " ", "Curvature", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"cd2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"w", "/", "\[Kappa]"}], ")"}], 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Kappa]", " ", 
          RowBox[{"w", "/", "2"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Kappa]", " ", 
          RowBox[{"w", "/", "2"}]}]}], ")"}]}], "]"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Diffusion", " ", "coeffcient", " ", "in", " ", "normal", " ", 
    "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "STUFF"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cd", "[", "u", "]"}], ",", 
       RowBox[{"w", "^", "2"}], ",", "cd2"}], "}"}], "/", 
     RowBox[{"w", "^", "2"}]}], ",", "domain1", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chG", "=", 
   RowBox[{"Channel2DGraphics", "[", 
    RowBox[{"mesh", ",", "\[Phi]", ",", "Sus"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chGG", "=", 
   RowBox[{"ParametricChannel2DGraphics", "[", 
    RowBox[{"p", ",", "u", ",", "v", ",", "1", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w1G", "=", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"p", "/.", 
      RowBox[{"v", "\[Rule]", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"uDomain", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"uDomain", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w2G", "=", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"p", "/.", 
      RowBox[{"v", "\[Rule]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"uDomain", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"uDomain", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w1G", ",", "w2G", ",", "chG"}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w1G", ",", "w2G", ",", "chG"}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "4"}], "-", 
         RowBox[{"1", "/", "16"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "-", 
         RowBox[{"1", "/", "16"}]}]}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chGG", "=", 
   RowBox[{"ParametricChannel2DGraphics", "[", 
    RowBox[{"p", ",", "u", ",", "v", ",", "levelsCount", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"chGG", ",", 
   RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"chGG", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "4"}], "-", 
         RowBox[{"1", "/", "16"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "-", 
         RowBox[{"1", "/", "16"}]}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]uv", "=", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{"\[Phi]uv", ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
      RowBox[{"Contours", "\[Rule]", "150"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "4"}]}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Thickness", "[", ".0007", "]"}], "]"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.787069006675988*^9, 3.78706919253578*^9}, {
   3.7870693283887997`*^9, 3.787069374150631*^9}, {3.787069414210472*^9, 
   3.78706951733004*^9}, {3.787069781840838*^9, 3.787069785925537*^9}, {
   3.787069949769552*^9, 3.787069956488593*^9}, {3.787070056495983*^9, 
   3.78707005791824*^9}, {3.787070259885565*^9, 3.787070274242687*^9}, 
   3.78707050248184*^9, {3.7870707895315943`*^9, 3.787070838327056*^9}, {
   3.787070936580247*^9, 3.787070995241879*^9}, {3.787071025891184*^9, 
   3.7870710694753103`*^9}, {3.787071358389009*^9, 3.787071359955591*^9}, {
   3.78707157774282*^9, 3.787071612212995*^9}, {3.787071655765856*^9, 
   3.787072030597417*^9}, {3.787072229464633*^9, 3.787072297566619*^9}, {
   3.787072328456594*^9, 3.787072345757565*^9}, {3.7871051403843927`*^9, 
   3.787105172353797*^9}, {3.787105204050467*^9, 3.7871052092345943`*^9}, {
   3.787106210398538*^9, 3.7871062831214113`*^9}, {3.787106394410678*^9, 
   3.78710643367649*^9}, {3.787106483097793*^9, 3.7871065673779793`*^9}, {
   3.787106600818625*^9, 3.78710672442703*^9}, {3.787106785971712*^9, 
   3.787106817163618*^9}, {3.787106948351416*^9, 3.78710694910144*^9}, {
   3.787106991503903*^9, 3.787107039220455*^9}, 3.787107098936511*^9, {
   3.787107233413474*^9, 3.7871072527550297`*^9}, {3.787107282884718*^9, 
   3.78710729740022*^9}, {3.7871073526765003`*^9, 3.787107383714326*^9}, {
   3.7871074194485273`*^9, 3.787107451216653*^9}, {3.787107483180442*^9, 
   3.7871074833829327`*^9}, {3.787107525318749*^9, 3.787107531295158*^9}, {
   3.787252958695437*^9, 3.7872529590235033`*^9}, {3.787252993093316*^9, 
   3.787253061465629*^9}, 3.787254069532626*^9, 3.787254123232031*^9, {
   3.787254642108871*^9, 3.787254642507139*^9}, {3.787254852083419*^9, 
   3.787254936043466*^9}, {3.787254987953546*^9, 3.787255021378388*^9}, {
   3.7872550540176783`*^9, 3.78725510999778*^9}, {3.787255308615612*^9, 
   3.787255328608244*^9}, {3.787255369519885*^9, 3.787255402155908*^9}, {
   3.7872554339041224`*^9, 3.787255442528405*^9}, {3.787255500328841*^9, 
   3.787255585008445*^9}, {3.787255626082391*^9, 3.78725568159262*^9}, {
   3.787255712766283*^9, 3.78725571759239*^9}, {3.7872557591953363`*^9, 
   3.787255775852084*^9}, {3.7872571405956163`*^9, 3.787257212438846*^9}, {
   3.7872572750118847`*^9, 3.787257332146475*^9}, {3.787257419354013*^9, 
   3.787257495462285*^9}, {3.787265076687788*^9, 3.7872650898485603`*^9}, {
   3.787265138416788*^9, 3.787265139538539*^9}, 3.7872756451994143`*^9, {
   3.7872767216677094`*^9, 3.787276752722247*^9}, {3.787277301601534*^9, 
   3.787277410489646*^9}, {3.7872774607829247`*^9, 3.787277499815455*^9}, 
   3.787277622760517*^9, {3.787277708628407*^9, 3.787277709603312*^9}, {
   3.7872779712774982`*^9, 3.787278013539452*^9}, {3.787278504924431*^9, 
   3.787278523774988*^9}, {3.787278589599646*^9, 3.78727865656153*^9}, 
   3.787278698055641*^9, {3.787278737162787*^9, 3.787278844008328*^9}, {
   3.787278889964122*^9, 3.7872788963075953`*^9}, {3.787278927671453*^9, 
   3.787278932718151*^9}, {3.787279057915999*^9, 3.787279063101947*^9}, {
   3.7872791521922073`*^9, 3.7872792061360598`*^9}, {3.787279254528352*^9, 
   3.787279260295147*^9}, {3.7872793028662243`*^9, 3.7872793396668453`*^9}, {
   3.7872793786863956`*^9, 3.78727938939515*^9}, {3.787279445149362*^9, 
   3.787279461465238*^9}, {3.787279500414009*^9, 3.787279513754879*^9}, {
   3.787279594339271*^9, 3.787279612932556*^9}, {3.787279717723885*^9, 
   3.787279720740334*^9}, {3.7872798696835833`*^9, 3.787279923557806*^9}, {
   3.787279998959753*^9, 3.7872801570469103`*^9}, {3.78728021738157*^9, 
   3.787280264620583*^9}, {3.787280329031392*^9, 3.787280356388969*^9}, {
   3.787280388959618*^9, 3.787280435879637*^9}, {3.787280494005167*^9, 
   3.787280498441373*^9}, 3.787280773592361*^9, {3.7872808484314203`*^9, 
   3.787280851110383*^9}, {3.787280946083495*^9, 3.787280957219366*^9}, {
   3.787281001564003*^9, 3.787281002921471*^9}, {3.787281033844261*^9, 
   3.787281048091345*^9}, {3.7872810989529247`*^9, 3.7872810990483923`*^9}, {
   3.787281134995596*^9, 3.7872811489894*^9}, {3.7872812477947807`*^9, 
   3.787281308003488*^9}, 3.7872828599701157`*^9, {3.78728322475482*^9, 
   3.7872832257681103`*^9}, {3.7872832897375402`*^9, 
   3.7872832902711287`*^9}, {3.7872838818535547`*^9, 3.787283903245572*^9}, {
   3.787283938338725*^9, 3.787284027434169*^9}, {3.7872842957470922`*^9, 
   3.787284338519335*^9}, {3.787312681830493*^9, 3.787312705453562*^9}, {
   3.787313087568733*^9, 3.7873131944242373`*^9}, {3.7873132372849827`*^9, 
   3.787313314232888*^9}, {3.787313414367948*^9, 3.787313432675949*^9}, {
   3.787313476406054*^9, 3.787313480724955*^9}, {3.787313577769026*^9, 
   3.787313587159205*^9}, {3.7873136233815536`*^9, 3.7873136300754023`*^9}, {
   3.787318056845817*^9, 3.787318159899932*^9}, {3.787318194889106*^9, 
   3.7873182009288387`*^9}, {3.78731829528124*^9, 3.787318325022799*^9}, {
   3.787318880814248*^9, 3.787318882894226*^9}, {3.7873189285706244`*^9, 
   3.787318964883803*^9}, {3.787319648716774*^9, 3.7873196498338327`*^9}, {
   3.78731973393636*^9, 3.787319777782115*^9}, {3.7873298938446417`*^9, 
   3.787329971603467*^9}, {3.787330395347292*^9, 3.787330494416497*^9}, 
   3.7873305874635277`*^9, {3.787330682836746*^9, 3.787330709319387*^9}, {
   3.787330871890749*^9, 3.787330958951221*^9}, {3.787330998053337*^9, 
   3.7873310585865602`*^9}, {3.787331139019805*^9, 3.787331164068762*^9}, {
   3.78733123365523*^9, 3.7873312371590548`*^9}, {3.787332593235875*^9, 
   3.787332613866214*^9}, {3.7873327261170197`*^9, 3.787332730265497*^9}, {
   3.787332761336241*^9, 3.787332809957943*^9}, {3.787332840339087*^9, 
   3.787332868951488*^9}, {3.787332900011911*^9, 3.787333132970714*^9}, {
   3.787333316160324*^9, 3.787333409679965*^9}, {3.787333461567073*^9, 
   3.787333515511992*^9}, {3.787333568123826*^9, 3.787333626887354*^9}, {
   3.787333853472518*^9, 3.7873339040534267`*^9}, {3.787333950549712*^9, 
   3.787333953970826*^9}, {3.787334110418085*^9, 3.7873341856542377`*^9}, {
   3.787334286039422*^9, 3.787334368555051*^9}, {3.787334765968569*^9, 
   3.787334832033181*^9}, {3.787334905158229*^9, 3.787334920215852*^9}, {
   3.787335016791684*^9, 3.7873350534899273`*^9}, {3.78733564707166*^9, 
   3.787335685189063*^9}, {3.787336063220541*^9, 3.7873361014436083`*^9}, {
   3.7873373942915154`*^9, 3.7873374568316393`*^9}, {3.787339701751081*^9, 
   3.787339728953291*^9}, {3.7873398763414717`*^9, 3.787339934262217*^9}, {
   3.787341143016316*^9, 3.7873411431339903`*^9}, {3.787342476375184*^9, 
   3.7873424772552347`*^9}, {3.787342631750005*^9, 3.787342631828641*^9}, {
   3.78734270718734*^9, 3.787342757267708*^9}, {3.787342841943612*^9, 
   3.787342929723207*^9}, {3.787351179213565*^9, 3.787351191855281*^9}, {
   3.787351240101056*^9, 3.787351351652336*^9}, {3.787351571183364*^9, 
   3.787351575711153*^9}, {3.7873517846014023`*^9, 3.787351804882695*^9}, {
   3.787351865760027*^9, 3.787351921673086*^9}, {3.787355710080517*^9, 
   3.787355711273624*^9}, 3.7873557457879257`*^9, {3.787359813284795*^9, 
   3.787359817461121*^9}, {3.78736063287748*^9, 3.787360632991544*^9}, {
   3.787360696215707*^9, 3.787360696677232*^9}, {3.7873607315267467`*^9, 
   3.7873607320342216`*^9}, {3.787396982599078*^9, 3.787397045331059*^9}, {
   3.7874412673169203`*^9, 3.787441267973419*^9}, {3.787442113950598*^9, 
   3.787442157809485*^9}, {3.787442197977377*^9, 3.7874425688222*^9}, {
   3.787442630649953*^9, 3.7874426982763433`*^9}, {3.7874427499778223`*^9, 
   3.7874427708825274`*^9}, {3.787481937081895*^9, 3.787482240582535*^9}, {
   3.7875051740045567`*^9, 3.787505174070281*^9}, {3.7875053809973993`*^9, 
   3.7875053810708523`*^9}, {3.787506713909285*^9, 3.787506811986936*^9}, {
   3.787507346501212*^9, 3.787507370566784*^9}, {3.7875074163162813`*^9, 
   3.787507424165435*^9}, {3.787510671831872*^9, 3.787510720162203*^9}, {
   3.787510812634934*^9, 3.7875108495601463`*^9}, {3.787512332896357*^9, 
   3.787512334766748*^9}, 3.787598927027566*^9, {3.787606686498968*^9, 
   3.7876067863542624`*^9}, {3.787606855765986*^9, 3.787606872477028*^9}, {
   3.7876069861880407`*^9, 3.787607105302786*^9}, {3.787607756552328*^9, 
   3.787607784859417*^9}, {3.787607815014144*^9, 3.78760786076993*^9}, 
   3.787607908720914*^9, {3.787607969771353*^9, 3.7876080057059937`*^9}, {
   3.787608050208098*^9, 3.787608111863493*^9}, {3.787608176320354*^9, 
   3.787608197695434*^9}, {3.787608250737915*^9, 3.7876083734536457`*^9}, {
   3.7877400842791653`*^9, 3.787740094874092*^9}, {3.7877405528811293`*^9, 
   3.787740763033247*^9}, {3.7877407962899323`*^9, 3.7877408030508003`*^9}, {
   3.787740858033997*^9, 3.787740935975326*^9}, {3.7877409853720703`*^9, 
   3.787741139956562*^9}, {3.787741531622191*^9, 3.787741560200316*^9}, {
   3.787741597935299*^9, 3.787741687673465*^9}, {3.787741771400467*^9, 
   3.787741771520556*^9}, {3.787741829401043*^9, 3.787741858016746*^9}, {
   3.787741979012281*^9, 3.7877419794282618`*^9}, {3.787742018090667*^9, 
   3.787742033108086*^9}, {3.787742099468493*^9, 3.787742101733494*^9}, {
   3.787742379072288*^9, 3.787742413247905*^9}, {3.787742792257936*^9, 
   3.787742793527224*^9}, {3.7877428908684397`*^9, 3.787742894714924*^9}, {
   3.787743056023079*^9, 3.787743060226862*^9}, {3.787743215967989*^9, 
   3.787743216859082*^9}, {3.787743301920912*^9, 3.787743334223837*^9}, {
   3.787743365164171*^9, 3.787743367542962*^9}, 3.78774359654007*^9, {
   3.787744496589456*^9, 3.787744570054872*^9}, {3.78774521183186*^9, 
   3.787745240437585*^9}, {3.7877452849605217`*^9, 3.787745286555563*^9}, {
   3.787746335757819*^9, 3.787746336209103*^9}, {3.787746380586512*^9, 
   3.787746406937693*^9}, {3.787746452963377*^9, 3.7877464819692173`*^9}, {
   3.787746576305257*^9, 3.7877465782507887`*^9}, {3.78796760187703*^9, 
   3.787967602213706*^9}, {3.78796778391603*^9, 3.7879677967965813`*^9}, 
   3.7931028382195*^9, 3.793102870027396*^9, {3.79310306650743*^9, 
   3.793103082531105*^9}, {3.793103276253243*^9, 3.793103276561304*^9}, {
   3.7931034468035297`*^9, 3.7931034574588633`*^9}, {3.809159146716991*^9, 
   3.809159292542892*^9}, {3.809159329362823*^9, 3.8091595696427393`*^9}, {
   3.809159923767302*^9, 3.8091599708153677`*^9}, {3.809160014324625*^9, 
   3.809160048988261*^9}, {3.80916033258342*^9, 3.809160332920719*^9}, {
   3.8091900326314*^9, 3.809190056101804*^9}, {3.809190200232501*^9, 
   3.809190255815185*^9}, {3.8091903015182447`*^9, 3.80919033167614*^9}, {
   3.809190370674199*^9, 3.809190435248869*^9}, {3.8091904663467827`*^9, 
   3.80919056832686*^9}, {3.809191262913965*^9, 3.809191263135202*^9}, {
   3.80919143535466*^9, 3.809191460709704*^9}, {3.809191765372696*^9, 
   3.8091917686061153`*^9}, {3.809191808434627*^9, 3.809191812158469*^9}, {
   3.8091920629413548`*^9, 3.809192080347835*^9}, {3.809192111067231*^9, 
   3.809192115465692*^9}, {3.809192198165373*^9, 3.809192212688684*^9}, {
   3.809192288023699*^9, 3.809192329110353*^9}, {3.8091923704213142`*^9, 
   3.809192373810898*^9}, {3.809192406010344*^9, 3.8091924286746597`*^9}, {
   3.809192483229837*^9, 3.8091925201191053`*^9}, {3.8091925514271727`*^9, 
   3.809192578938716*^9}, {3.809192701699277*^9, 3.809192703816497*^9}, {
   3.809194881657346*^9, 3.8091949038561087`*^9}, {3.809195136715995*^9, 
   3.809195170291849*^9}, {3.809195238408945*^9, 3.8091952904940357`*^9}, {
   3.809195322887476*^9, 3.809195455754182*^9}, {3.8874436272978992`*^9, 
   3.887443627366908*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"ad2fd419-cac9-41f5-881d-56245c6d12a0"],

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Sigma]", "[", "u", "]"}], ",", "domain1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Sigma]", "[", "0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"2", 
  RowBox[{"N", "[", "w", "]"}]}]}], "Input",
 CellChangeTimes->{{3.793103230157023*^9, 3.793103243977394*^9}, {
  3.793103312707391*^9, 3.793103394713292*^9}, {3.7931034271065273`*^9, 
  3.793103436089382*^9}, {3.7931034808203897`*^9, 3.793103545057456*^9}, {
  3.793103757002359*^9, 3.7931037961043463`*^9}, {3.7931038471460543`*^9, 
  3.7931038668160152`*^9}, {3.793103939009796*^9, 3.793103943320078*^9}, {
  3.793103976417284*^9, 3.7931040461996307`*^9}, {3.793104083432972*^9, 
  3.7931040861997337`*^9}, {3.7931047972459373`*^9, 3.793104851998157*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2cb9b576-e17d-4e58-bb3c-2b8ff49c4785"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setting", " ", "initial", " ", "condition"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"u0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"1", "/", "40"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", "50.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bmp", "=", " ", 
     RowBox[{"bumpFunction", "[", 
      RowBox[{"k", ",", "u0", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"bmp", "[", "u", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"max", " ", 
      RowBox[{"bmp", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{"1", "/", "2"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "max"}], "}"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7875994222156982`*^9, 3.7875994231409073`*^9}, {
   3.787599464343091*^9, 3.787599525865348*^9}, 3.7875997266748857`*^9, {
   3.787599799391409*^9, 3.787599801203032*^9}, {3.787600125620842*^9, 
   3.787600140083968*^9}, {3.787600274084306*^9, 3.787600274868325*^9}, {
   3.787600509219439*^9, 3.787600624326898*^9}, {3.7876009684598722`*^9, 
   3.787600989408491*^9}, {3.787603993462016*^9, 3.787603998122654*^9}, {
   3.787604735750082*^9, 3.787604741694581*^9}, {3.7876048280359383`*^9, 
   3.787604828175315*^9}, 3.7877436691098633`*^9, {3.809158818954318*^9, 
   3.809158821237666*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"f3827f9c-e0db-48ee-a9d4-ee59d2540c22"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Solving", " ", "heat", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bc1", "=", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
       "borderA"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc2", "=", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
       "borderB"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tMax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"NDSolveValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HeatEquation", ",", " ", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"0", ",", "x", ",", "y"}], "]"}], "\[Equal]", 
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], ",", "bc1", ",", "bc2"}], "}"}], 
       ",", " ", "\[Psi]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "y"}], "}"}], " ", "\[Element]", " ", 
        "mesh"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7876039539386272`*^9, 3.787603954291586*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"0711940f-3f06-47af-a08d-c03150057081"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DensityPlot", "[", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "max"}], "}"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "728"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "20"}], ",", 
       RowBox[{"MeshFunctions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"#3", "&"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.0001", ",", "0.04", ",", ".0002"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListAnimate", "[", 
  RowBox[{"frames", ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "False"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7875273090966473`*^9, 3.787527317327722*^9}, {
   3.787527365447846*^9, 3.787527382398397*^9}, {3.7875274526084337`*^9, 
   3.787527457713543*^9}, {3.787527737950164*^9, 3.787527738449739*^9}, {
   3.7875278768999577`*^9, 3.787527882420039*^9}, {3.787599117458323*^9, 
   3.787599147680476*^9}, {3.7875991839053164`*^9, 3.787599188384626*^9}, {
   3.78759936802302*^9, 3.787599439702978*^9}, {3.7875996400601463`*^9, 
   3.787599641470379*^9}, {3.787599881954417*^9, 3.787599888043462*^9}, {
   3.787599983145203*^9, 3.787599992908162*^9}, {3.787600082457184*^9, 
   3.787600085158433*^9}, {3.787600162941689*^9, 3.787600163916753*^9}, {
   3.7876003793498373`*^9, 3.7876003794611893`*^9}, {3.787600728280939*^9, 
   3.7876007312892323`*^9}, {3.787600961507262*^9, 3.787600961600988*^9}, {
   3.7876012571261797`*^9, 3.787601266929744*^9}, {3.787601716458125*^9, 
   3.787601717353711*^9}, {3.78760204384511*^9, 3.787602044209845*^9}, {
   3.7876036916505337`*^9, 3.787603695763269*^9}, 3.787603951645794*^9, {
   3.787604556597907*^9, 3.7876045741020517`*^9}, {3.787604700192565*^9, 
   3.78760470211576*^9}, {3.787604784068799*^9, 3.7876047847827463`*^9}, {
   3.787604888040351*^9, 3.787604932311636*^9}, {3.809158847722665*^9, 
   3.809158849765274*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"2f8ad00c-e7e9-42a8-b226-de52ba5fc579"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]x", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", "\[Phi]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]y", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Phi]Sq", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]x", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"\[Phi]y", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "t_", "]"}], ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], 
        RowBox[{
         RowBox[{"\[Phi]x", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "/", 
         RowBox[{"g\[Phi]Sq", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], 
        RowBox[{
         RowBox[{"\[Phi]y", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "/", 
         RowBox[{"g\[Phi]Sq", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pf", "[", "t_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ps", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ps", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fieldFlux", "[", 
           RowBox[{"W", "[", "t", "]"}], "]"}], "/@", "Sus"}], ")"}], "/", 
        RowBox[{"\[Sigma]", "[", "us", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"interpolate", "[", 
       RowBox[{"us", ",", "ps"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"uMin", ",", "uMax"}], "}"}], "=", "uDomain"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pfs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pf", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.0005", ",", "0.2", ",", ".0005"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pfs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "uMin", ",", "uMax"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"max", "+", "1"}]}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pfs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListAnimate", "[", 
  RowBox[{"frames", ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "False"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.787510331044784*^9, 3.787510524929625*^9}, {
   3.7875105706419*^9, 3.787510620722389*^9}, {3.787510779911096*^9, 
   3.787510780391152*^9}, 3.787510975616467*^9, {3.787511033005329*^9, 
   3.78751104413169*^9}, {3.7875110898222017`*^9, 3.7875111155236588`*^9}, {
   3.787511147070836*^9, 3.787511147210019*^9}, {3.787511429976698*^9, 
   3.7875114466696377`*^9}, 3.787512314900014*^9, {3.809158896790097*^9, 
   3.8091588986454973`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"08d9e099-a517-44e0-bed6-035a4dd9015f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"no", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"err", "[", "t_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"P", "[", 
       RowBox[{"t", ",", 
        RowBox[{"Sus", "[", 
         RowBox[{"[", 
          RowBox[{"no", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"Sus", "[", 
         RowBox[{"[", 
          RowBox[{"no", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"no", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"error", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"P", "[", 
           RowBox[{"t", ",", 
            RowBox[{"Sus", "[", 
             RowBox[{"[", 
              RowBox[{"no", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Sus", "[", 
             RowBox[{"[", 
              RowBox[{"no", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", ".0001", ",", ".1", ",", ".0001"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"no", ",", "40", ",", "60"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"error", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.787515148271541*^9, 3.787515361712016*^9}, {
  3.787515414155346*^9, 3.787515663261842*^9}, {3.7875157343729277`*^9, 
  3.78751574804838*^9}, {3.7875157816571007`*^9, 3.787515858468635*^9}, {
  3.787515945886733*^9, 3.787516013686946*^9}, {3.787516115272852*^9, 
  3.787516164798676*^9}, {3.787516206030898*^9, 3.7875162943037367`*^9}, {
  3.787516384131833*^9, 3.7875163886886272`*^9}, {3.787516431444839*^9, 
  3.787516459440275*^9}, {3.787516501142124*^9, 3.787516504596451*^9}, {
  3.787516582060178*^9, 3.787516611954726*^9}, {3.787516678347541*^9, 
  3.787516715358377*^9}, {3.787516745729508*^9, 3.787516764980089*^9}, {
  3.787516808033547*^9, 3.787516965510705*^9}, {3.787517003350453*^9, 
  3.787517010638633*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"bab4fc79-d6d8-4f30-9a23-f0b7bd37bbe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"err", "[", "t_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"us", "[", 
        RowBox[{"[", "no", "]"}], "]"}], ",", 
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"P", "[", 
         RowBox[{"t", ",", 
          RowBox[{"Sus", "[", 
           RowBox[{"[", 
            RowBox[{"no", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Sus", "[", 
           RowBox[{"[", 
            RowBox[{"no", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"no", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"err", "[", "t", "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", ".2"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", ".1", ",", ".001"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListAnimate", "[", 
  RowBox[{"frames", ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "False"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   RowBox[{"AppearanceElements", "\[Rule]", "\"\<Labeled\>\""}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.787516985026636*^9, 3.787517153286042*^9}, {
  3.7875171945179567`*^9, 3.787517278947879*^9}, {3.7875173982337*^9, 
  3.787517399160738*^9}, {3.787521036480033*^9, 3.7875210472839527`*^9}, {
  3.787521264814783*^9, 3.787521271477664*^9}, {3.78752130816044*^9, 
  3.787521308998266*^9}, {3.787521341682129*^9, 3.787521343941847*^9}, {
  3.787522069750374*^9, 3.787522131535219*^9}, {3.787522162874176*^9, 
  3.787522163058798*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"94bcdfbb-177f-4df2-8f09-f13932998139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"us", "[", 
        RowBox[{"[", "no", "]"}], "]"}], ",", 
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"h", "[", 
         RowBox[{
          RowBox[{"Sus", "[", 
           RowBox[{"[", 
            RowBox[{"no", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Sus", "[", 
           RowBox[{"[", 
            RowBox[{"no", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"no", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ll", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.787527140348855*^9, 3.787527147209125*^9}, {
  3.787527417222577*^9, 3.787527421189254*^9}, {3.7875274745528307`*^9, 
  3.7875275922319603`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"379795df-c9ff-4c46-b9fc-d182358a535c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "w", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"prm", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"w", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Kappa]", " ", "v", " ", "w"}]}], ")"}]}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"prm", "/.", 
     RowBox[{"v", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{"prm", "/.", 
     RowBox[{"v", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]}]}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7876258436193953`*^9, 3.7876259426308002`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1f0179fa-a620-4a57-81c7-5c799de62e6d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.809192241869866*^9, 
  3.80919227945905*^9}},ExpressionUUID->"ffffffff-ffff-4fff-bfff-\
ffffffffffff"],

Cell[BoxData["uDomain"], "Input",
 CellChangeTimes->{{3.809192348195753*^9, 3.809192349308416*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"],

Cell[BoxData["w"], "Input",
 CellChangeTimes->{{3.809192590117444*^9, 3.809192591228752*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"]
},
WindowSize->{1125., 1042.875},
WindowMargins->{{Automatic, 7.875}, {-10.875, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"12e4933c-aaea-4684-a5fa-c34fadc4cfb2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 22519, 466, 1312, "Input",ExpressionUUID->"ad2fd419-cac9-41f5-881d-56245c6d12a0"],
Cell[23080, 488, 855, 15, 90, "Input",ExpressionUUID->"2cb9b576-e17d-4e58-bb3c-2b8ff49c4785"],
Cell[23938, 505, 2495, 64, 246, "Input",ExpressionUUID->"f3827f9c-e0db-48ee-a9d4-ee59d2540c22"],
Cell[26436, 571, 1601, 43, 168, "Input",ExpressionUUID->"0711940f-3f06-47af-a08d-c03150057081"],
Cell[28040, 616, 2476, 47, 116, "Input",ExpressionUUID->"2f8ad00c-e7e9-42a8-b226-de52ba5fc579"],
Cell[30519, 665, 3852, 112, 324, "Input",ExpressionUUID->"08d9e099-a517-44e0-bed6-035a4dd9015f"],
Cell[34374, 779, 2458, 60, 168, "Input",ExpressionUUID->"bab4fc79-d6d8-4f30-9a23-f0b7bd37bbe4"],
Cell[36835, 841, 2007, 50, 116, "Input",ExpressionUUID->"94bcdfbb-177f-4df2-8f09-f13932998139"],
Cell[38845, 893, 1037, 28, 64, "Input",ExpressionUUID->"379795df-c9ff-4c46-b9fc-d182358a535c"],
Cell[39885, 923, 800, 23, 90, "Input",ExpressionUUID->"1f0179fa-a620-4a57-81c7-5c799de62e6d"],
Cell[40688, 948, 151, 3, 37, "Input",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"],
Cell[40842, 953, 182, 3, 37, "Input",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"],
Cell[41027, 958, 176, 3, 37, "Input",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"]
}
]
*)

