(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10315,        253]
NotebookOptionsPosition[      9688,        234]
NotebookOutlinePosition[     10040,        250]
CellTagsIndexPosition[      9997,        247]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Util", " ", "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"grad", "[", "f_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", "x"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", "y"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"star", "[", "U_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"U", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"U", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Metric", " ", "in", " ", "sphere", " ", "of", " ", "radius", " ", "r"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nf", "=", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]f", "=", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"nf", "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "R"}], ")"}], "^", "2"}]}]}], ")"}], "^", "2"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Harmonic", " ", "function", " ", "sphere"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{
      RowBox[{"Log", "[", "nf", "]"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gu", "=", 
     RowBox[{"grad", "[", "u", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"gu", "/", 
       RowBox[{"(", 
        RowBox[{"\[Mu]f", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{"gu", ",", "gu"}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stU", "=", 
     RowBox[{"star", "[", "U", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "\[Sigma]"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"\[Gamma]", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Rule]", 
        RowBox[{"r", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{"r", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"u", "/.", "\[Gamma]"}], ",", 
      RowBox[{"r", ">", "0"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]d", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "/.", "\[Gamma]"}], ",", 
       "\[Theta]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hh", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"stU", "/.", "\[Gamma]"}], ",", "\[Gamma]d"}], "]"}], ",", 
       RowBox[{"r", ">", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{"hh", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"r", ">", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Limit", "[", 
    RowBox[{"sol", ",", 
     RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stGU", "=", 
     RowBox[{"star", "[", "gu", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hh", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"stGU", "/.", "\[Gamma]"}], ",", "\[Gamma]d"}], "]"}], ",", 
       RowBox[{"r", ">", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{"hh", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"r", ">", "0"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.785005869519442*^9, 3.785005929767974*^9}, {
   3.785005967717371*^9, 3.7850061302281103`*^9}, {3.785006162858939*^9, 
   3.7850062720598183`*^9}, {3.7850063341962357`*^9, 
   3.7850063774040327`*^9}, {3.785007591827384*^9, 3.785007617347515*^9}, {
   3.785007699605146*^9, 3.785007706011073*^9}, {3.785007817602531*^9, 
   3.785008200482874*^9}, {3.785008231318077*^9, 3.785008297091092*^9}, {
   3.7850236547634373`*^9, 3.7850237983390827`*^9}, {3.785023828731542*^9, 
   3.785023875760998*^9}, 3.785024072453409*^9, 3.7850241647015533`*^9, {
   3.785024536745323*^9, 3.785024553802415*^9}, {3.785024609118545*^9, 
   3.7850247287172327`*^9}, {3.7850247857470417`*^9, 3.785025006492673*^9}, {
   3.785025043626066*^9, 3.7850252598774757`*^9}, {3.785025334920277*^9, 
   3.7850253916425877`*^9}, {3.785074373197672*^9, 3.785074480846855*^9}, {
   3.785074569738619*^9, 3.785074593526515*^9}, {3.785074813145473*^9, 
   3.785074823842442*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"1d102a90-5c71-4f56-9472-17cdeb6c4fe1"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "3"], "+", 
      RowBox[{"16", " ", "r", " ", 
       SuperscriptBox["R", "2"]}]}], ")"}], "2"], " ", "\[Theta]"}], 
  RowBox[{"256", " ", 
   SuperscriptBox["R", "4"]}]]], "Output",
 CellChangeTimes->{{3.785007862469697*^9, 3.785007882097149*^9}, 
   3.785007912503592*^9, {3.78500796544228*^9, 3.785007970519182*^9}, {
   3.785008012885992*^9, 3.785008132188614*^9}, {3.785008184533201*^9, 
   3.785008202563081*^9}, {3.785008243018293*^9, 3.785008297526175*^9}, {
   3.7850237631720133`*^9, 3.785023785829154*^9}, {3.785023829112543*^9, 
   3.785023876069601*^9}, 3.785024072870337*^9, {3.785024161777594*^9, 
   3.7850241651685123`*^9}, 3.785024554744011*^9, {3.785024612043252*^9, 
   3.785024671106895*^9}, 3.7850247293920727`*^9, {3.785024803698771*^9, 
   3.7850248374116173`*^9}, {3.7850248721226788`*^9, 3.785024912717105*^9}, {
   3.78502495268677*^9, 3.785025006961007*^9}, {3.7850250457134733`*^9, 
   3.78502507414262*^9}, {3.785025129058094*^9, 3.785025260661117*^9}, {
   3.785025336722129*^9, 3.7850253921783*^9}, {3.7850743747906027`*^9, 
   3.7850744000548487`*^9}, 3.7850744338254347`*^9, 3.785074486866414*^9, {
   3.785074603590804*^9, 3.7850746186720877`*^9}, 3.785074661627042*^9, 
   3.7850748248589563`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"26323867-2fea-41af-b3fb-a5a626818e36"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", "\[Theta]"}]], "Output",
 CellChangeTimes->{{3.785007862469697*^9, 3.785007882097149*^9}, 
   3.785007912503592*^9, {3.78500796544228*^9, 3.785007970519182*^9}, {
   3.785008012885992*^9, 3.785008132188614*^9}, {3.785008184533201*^9, 
   3.785008202563081*^9}, {3.785008243018293*^9, 3.785008297526175*^9}, {
   3.7850237631720133`*^9, 3.785023785829154*^9}, {3.785023829112543*^9, 
   3.785023876069601*^9}, 3.785024072870337*^9, {3.785024161777594*^9, 
   3.7850241651685123`*^9}, 3.785024554744011*^9, {3.785024612043252*^9, 
   3.785024671106895*^9}, 3.7850247293920727`*^9, {3.785024803698771*^9, 
   3.7850248374116173`*^9}, {3.7850248721226788`*^9, 3.785024912717105*^9}, {
   3.78502495268677*^9, 3.785025006961007*^9}, {3.7850250457134733`*^9, 
   3.78502507414262*^9}, {3.785025129058094*^9, 3.785025260661117*^9}, {
   3.785025336722129*^9, 3.7850253921783*^9}, {3.7850743747906027`*^9, 
   3.7850744000548487`*^9}, 3.7850744338254347`*^9, 3.785074486866414*^9, {
   3.785074603590804*^9, 3.7850746186720877`*^9}, 3.785074661627042*^9, 
   3.785074824869932*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"0dfc6cfc-ffec-4051-88e5-821cc8a8b692"],

Cell[BoxData["\[Theta]"], "Output",
 CellChangeTimes->{{3.785007862469697*^9, 3.785007882097149*^9}, 
   3.785007912503592*^9, {3.78500796544228*^9, 3.785007970519182*^9}, {
   3.785008012885992*^9, 3.785008132188614*^9}, {3.785008184533201*^9, 
   3.785008202563081*^9}, {3.785008243018293*^9, 3.785008297526175*^9}, {
   3.7850237631720133`*^9, 3.785023785829154*^9}, {3.785023829112543*^9, 
   3.785023876069601*^9}, 3.785024072870337*^9, {3.785024161777594*^9, 
   3.7850241651685123`*^9}, 3.785024554744011*^9, {3.785024612043252*^9, 
   3.785024671106895*^9}, 3.7850247293920727`*^9, {3.785024803698771*^9, 
   3.7850248374116173`*^9}, {3.7850248721226788`*^9, 3.785024912717105*^9}, {
   3.78502495268677*^9, 3.785025006961007*^9}, {3.7850250457134733`*^9, 
   3.78502507414262*^9}, {3.785025129058094*^9, 3.785025260661117*^9}, {
   3.785025336722129*^9, 3.7850253921783*^9}, {3.7850743747906027`*^9, 
   3.7850744000548487`*^9}, 3.7850744338254347`*^9, 3.785074486866414*^9, {
   3.785074603590804*^9, 3.7850746186720877`*^9}, 3.785074661627042*^9, 
   3.785074824874653*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"b275aeb0-7aa7-4657-b4b1-5733710a198f"]
}, Open  ]]
},
WindowSize->{816, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5282, 143, 493, "Input",ExpressionUUID->"1d102a90-5c71-4f56-9472-17cdeb6c4fe1"],
Cell[5865, 167, 1429, 26, 58, "Output",ExpressionUUID->"26323867-2fea-41af-b3fb-a5a626818e36"],
Cell[7297, 195, 1209, 18, 34, "Output",ExpressionUUID->"0dfc6cfc-ffec-4051-88e5-821cc8a8b692"],
Cell[8509, 215, 1163, 16, 68, "Output",ExpressionUUID->"b275aeb0-7aa7-4657-b4b1-5733710a198f"]
}, Open  ]]
}
]
*)

